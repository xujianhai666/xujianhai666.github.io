<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Zero xu ">
<meta name="description" content="入门学习:
 学习写一个多线程的 echo server: https://hermanradtke.com/2015/07/22/creating-a-multi-echo-server-using-rust-and-mio.html  其他的框架学习:
 mio : https://fugangqiang.github.io/posts/rust/rust%E4%B9%8Bmio.html futures tokio  rust学习资料: rust每日新闻: https://github.com/RustStudy/rust_daily_news rust社区: https://rust.cc/ rust中文: https://rustlang-cn.org/ rust新闻: https://www.yuque.com/chaosbot/rustnews rust文档: https://doc.rust-lang.org/stable/book rust官方设计: https://github.com/rust-lang/rfcs
feature https://wiki.jikexueyuan.com/project/rust-primer/intoborrow/borrow.html 内部等价性 怎么理解 ？ ToOwned 不理解
Borrow 的前后类型之间要求必须有内部等价性。不具有这个等价性的两个类型之间，不能实现 Borrow。 AsRef 更通用，更普遍，覆盖类型更多，是 Borrow 的超集。 slab 是怎么使用的呢? token？ 啥时候放进去的? 返回值 ?
这种情况会返回什么? let event = self.events.get(i).ok_or_else(|| { io::Error::new(ErrorKind::Other, &amp;ldquo;Failed to get event&amp;rdquo;) })?;
很多返回结果并没有处理
特殊的打印格式: {:?} 变量可以重新绑定; 可以多变量绑定 特殊的数据类型: isize usize; &amp;amp;str string; 元类型和指针类型 这个还是很全的: https://wiki." />
<meta name="keywords" content="homepage, blog, science, informatics, development, programming" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://xujianhai.fun/posts/rust_learn/" />


    <title>
        
            Rust_learn :: zero.xu blog  — Hello Friend
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://xujianhai.fun/main.min.5dcefbf8102eb536dd3e2de53ffebfa58599ab2435c241a0db81728a5e015f2e.css">




<meta itemprop="name" content="Rust_learn">
<meta itemprop="description" content="入门学习:
 学习写一个多线程的 echo server: https://hermanradtke.com/2015/07/22/creating-a-multi-echo-server-using-rust-and-mio.html  其他的框架学习:
 mio : https://fugangqiang.github.io/posts/rust/rust%E4%B9%8Bmio.html futures tokio  rust学习资料: rust每日新闻: https://github.com/RustStudy/rust_daily_news rust社区: https://rust.cc/ rust中文: https://rustlang-cn.org/ rust新闻: https://www.yuque.com/chaosbot/rustnews rust文档: https://doc.rust-lang.org/stable/book rust官方设计: https://github.com/rust-lang/rfcs
feature https://wiki.jikexueyuan.com/project/rust-primer/intoborrow/borrow.html 内部等价性 怎么理解 ？ ToOwned 不理解
Borrow 的前后类型之间要求必须有内部等价性。不具有这个等价性的两个类型之间，不能实现 Borrow。 AsRef 更通用，更普遍，覆盖类型更多，是 Borrow 的超集。 slab 是怎么使用的呢? token？ 啥时候放进去的? 返回值 ?
这种情况会返回什么? let event = self.events.get(i).ok_or_else(|| { io::Error::new(ErrorKind::Other, &ldquo;Failed to get event&rdquo;) })?;
很多返回结果并没有处理
特殊的打印格式: {:?} 变量可以重新绑定; 可以多变量绑定 特殊的数据类型: isize usize; &amp;str string; 元类型和指针类型 这个还是很全的: https://wiki.">
<meta itemprop="datePublished" content="2019-04-11T16:01:17&#43;08:00" />
<meta itemprop="dateModified" content="2019-04-11T16:01:17&#43;08:00" />
<meta itemprop="wordCount" content="245">
<meta itemprop="image" content="https://xujianhai.fun/"/>



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://xujianhai.fun/"/>

<meta name="twitter:title" content="Rust_learn"/>
<meta name="twitter:description" content="入门学习:
 学习写一个多线程的 echo server: https://hermanradtke.com/2015/07/22/creating-a-multi-echo-server-using-rust-and-mio.html  其他的框架学习:
 mio : https://fugangqiang.github.io/posts/rust/rust%E4%B9%8Bmio.html futures tokio  rust学习资料: rust每日新闻: https://github.com/RustStudy/rust_daily_news rust社区: https://rust.cc/ rust中文: https://rustlang-cn.org/ rust新闻: https://www.yuque.com/chaosbot/rustnews rust文档: https://doc.rust-lang.org/stable/book rust官方设计: https://github.com/rust-lang/rfcs
feature https://wiki.jikexueyuan.com/project/rust-primer/intoborrow/borrow.html 内部等价性 怎么理解 ？ ToOwned 不理解
Borrow 的前后类型之间要求必须有内部等价性。不具有这个等价性的两个类型之间，不能实现 Borrow。 AsRef 更通用，更普遍，覆盖类型更多，是 Borrow 的超集。 slab 是怎么使用的呢? token？ 啥时候放进去的? 返回值 ?
这种情况会返回什么? let event = self.events.get(i).ok_or_else(|| { io::Error::new(ErrorKind::Other, &ldquo;Failed to get event&rdquo;) })?;
很多返回结果并没有处理
特殊的打印格式: {:?} 变量可以重新绑定; 可以多变量绑定 特殊的数据类型: isize usize; &amp;str string; 元类型和指针类型 这个还是很全的: https://wiki."/>





    <meta property="article:published_time" content="2019-04-11 16:01:17 &#43;0800 CST" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://xujianhai.fun/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">zero.xu|blog</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://xujianhai.fun/about/">About</a></li><li><a href="https://xujianhai.fun/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>2 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="https://xujianhai.fun/posts/rust_learn/">Rust_learn</a>
            </h1>

            

            <div class="post-content">
                <p>入门学习:</p>
<ul>
<li>学习写一个多线程的 echo server: <a href="https://hermanradtke.com/2015/07/22/creating-a-multi-echo-server-using-rust-and-mio.html">https://hermanradtke.com/2015/07/22/creating-a-multi-echo-server-using-rust-and-mio.html</a></li>
</ul>
<p>其他的框架学习:</p>
<ul>
<li>mio : <a href="https://fugangqiang.github.io/posts/rust/rust%E4%B9%8Bmio.html">https://fugangqiang.github.io/posts/rust/rust%E4%B9%8Bmio.html</a></li>
<li>futures</li>
<li>tokio</li>
</ul>
<p>rust学习资料:
rust每日新闻: <a href="https://github.com/RustStudy/rust_daily_news">https://github.com/RustStudy/rust_daily_news</a>
rust社区: <a href="https://rust.cc/">https://rust.cc/</a>
rust中文: <a href="https://rustlang-cn.org/">https://rustlang-cn.org/</a>
rust新闻: <a href="https://www.yuque.com/chaosbot/rustnews">https://www.yuque.com/chaosbot/rustnews</a>
rust文档: <a href="https://doc.rust-lang.org/stable/book">https://doc.rust-lang.org/stable/book</a>
rust官方设计: <a href="https://github.com/rust-lang/rfcs">https://github.com/rust-lang/rfcs</a></p>
<h2 id="feature">feature</h2>
<p><a href="https://wiki.jikexueyuan.com/project/rust-primer/intoborrow/borrow.html">https://wiki.jikexueyuan.com/project/rust-primer/intoborrow/borrow.html</a>
内部等价性 怎么理解 ？
ToOwned 不理解</p>
<pre><code>Borrow 的前后类型之间要求必须有内部等价性。不具有这个等价性的两个类型之间，不能实现 Borrow。

AsRef 更通用，更普遍，覆盖类型更多，是 Borrow 的超集。
</code></pre><p>slab 是怎么使用的呢?
token？ 啥时候放进去的?
返回值 ?</p>
<p>这种情况会返回什么?
let event = self.events.get(i).ok_or_else(|| {
io::Error::new(ErrorKind::Other, &ldquo;Failed to get event&rdquo;)
})?;</p>
<p>很多返回结果并没有处理</p>
<p>特殊的打印格式:
{:?}
变量可以重新绑定; 可以多变量绑定
特殊的数据类型: isize usize; &amp;str string; 元类型和指针类型
这个还是很全的: <a href="https://wiki.jikexueyuan.com/project/rust-primer/quickstart/primitive-type.html">https://wiki.jikexueyuan.com/project/rust-primer/quickstart/primitive-type.html</a>
vec!
不多于32个元素的数组和不多于12个元素的元组在值传递时是自动复制的
只能使用as关键字显式转换
type 类型定义, go也支持
str = &amp;&lsquo;static str； &amp;str 本质上是 数组 &amp;[u8]；String 是 vec:Vec<!-- raw HTML omitted --></p>
<p>hup event ？
match self.connection(token).writable() { 竟然会error</p>
<p>conns: Slab<!-- raw HTML omitted -->,</p>
<p>看下这些实现
Drop提供了当一个值退出作用域后执行代码的功能，它只有一个drop(&amp;mut self)方法。
Borrow用于创建一个数据结构时把拥有和借用的值看作等同。
AsRef用于在泛型中把一个值转换为引用。
Deref&lt;Target=T&gt;用于把&amp;U类型的值自动转换为&amp;T类型。
Iterator用于在集合 (collection) 和惰性值生成器 (lazy value generator) 上实现迭代器。
Sized用于标记运行时长度固定的类型，而不定长的切片和特性必须放在指针后面使其运行时长度已知， 比如&amp;[T]和Box<!-- raw HTML omitted -->。</p>
<p>VecDeque</p>
<p>不太理解
let mut recv_buf : Vec<!-- raw HTML omitted --> = Vec::with_capacity(msg_len);
unsafe { recv_buf.set_len(msg_len); }</p>
<p>抄写一遍</p>
<p>先 mio, 在 tokio</p>
<p>unwrap</p>
<p>move || ?</p>
<p>let graph = SimpleGraph;
let object = Box::new(graph) as Box&lt;Graph&lt;N=Node, E=Edge&raquo;;</p>
<p>while let 是？
<a href="https://wiki.jikexueyuan.com/project/rust-primer/quickstart/control-flow.html">https://wiki.jikexueyuan.com/project/rust-primer/quickstart/control-flow.html</a></p>
<p>泛型？
impl Trait and generics work with any trait ? trait 和 Trait 差异很大</p>
<p>struct对于 引用的处理
<a href="https://wiki.jikexueyuan.com/project/rust-primer/type/compound-types.html">https://wiki.jikexueyuan.com/project/rust-primer/type/compound-types.html</a>
结构体里的引用字段必须要有显式的生命周期
你调用了一下别人，然后你就不属于你了</p>
<p>生命周期&amp;所有权</p>
<h2 id="问题">问题</h2>
<p>rust 的泛型 是怎么实现的 ?</p>
<p>对于多态函数，存在两种派分 (dispatch) 机制：静态派分和动态派分。 前者类似于C++的模板，Rust会生成适用于指定类型的特殊函数，然后在被调用的位置进行替换， 好处是允许函数被内联调用，运行比较快，但是会导致代码膨胀 (code bloat)； 后者类似于Java或Go的interface，Rust通过引入特性对象 (trait object) 来实现， 在运行期查找虚表 (vtable) 来选择执行的方法。特性对象&amp;Foo具有和特性Foo相同的名称， 通过转换 (casting) 或者强制多态化 (coercing) 一个指向具体类型的指针来创建</p>
<p>dyn trait 的差异
<a href="https://zhuanlan.zhihu.com/p/109990547">https://zhuanlan.zhihu.com/p/109990547</a>
it also supports dynamic dispatch through a mechanism called ‘trait objects’.
Rust 编译器会通过单态化(Monomorphization) 将泛型函数展开
想起了any的实现, 本质上也是编译后代码生成 多种实现
Rust 的 trait object 使用了与 c++ 类似的 vtable 实现, trait object 含有1个指向实际类型的 data 指针, 和一个指向实际类型实现 trait 函数的 vtable, 以此实现动态分发. 更加详细的介绍
<a href="https://alschwalm.com/blog/static/2017/03/07/exploring-dynamic-dispatch-in-rust/">https://alschwalm.com/blog/static/2017/03/07/exploring-dynamic-dispatch-in-rust/</a>
<code>fn some_fn(param1: i32, param2: i32) -&gt; &amp;'static View {</code> 用拥有所有权的 Box 智能指针避免烦人的生命周期说明
<a href="https://github.com/rust-lang/rfcs/blob/master/text/2113-dyn-trait-syntax.md">https://github.com/rust-lang/rfcs/blob/master/text/2113-dyn-trait-syntax.md</a>  协议改造
<a href="https://doc.rust-lang.org/book/trait-objects.html#representation">https://doc.rust-lang.org/book/trait-objects.html#representation</a></p>

            </div>
        </article>

        <hr />

        <div class="post-info">

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>245 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2019-04-11 16:01 &#43;0800</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://xujianhai.fun/posts/tmq-oom/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Tmq Oom</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://xujianhai.fun/posts/github_lb/">
                                <span class="button__text">Github_lb</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
                <span><a href="https://xujianhai.fun/">Zero xu</a></span>
            
            <span></span>
            <span> <a href="https://xujianhai.fun/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://xujianhai.fun/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
